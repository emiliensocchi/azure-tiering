# 🌩️ Azure roles tiering

Tiering of common Microsoft Azure roles **based on known attack paths**.

## 📃 Tier definition

> [!IMPORTANT]
> This model attempts to tier **common** Azure roles

| Color | Tier | Name | Definition |
|---|---|---|---|
| 🔴 | 0 | [Family of privilege ascenders](#tier-0) | Roles with a risk of privilege escalation via one or multiple resource types in scope. |
| 🟠 | 1 | [Family of lateral navigators](#tier-1) | Roles with a risk of lateral movement via data-plane access to a specific resource type in scope, but with a limited risk for privilege escalation. |
| 🟡 | 2 | [Family of data explorers](#tier-2) | Roles with data-plane access to a specific resource type in scope, but with a limited risk for lateral movement and without a risk for privilege escalation. |
| 🟢 | 3 | [Family of unprivileged Azure users](#tier-3) | Roles with little to no security implications. | 


<a id='tier-0'></a>
## 🔴 Tier 0: Family of privilege ascenders

**Description**: roles with a risk of privilege escalation via one or multiple resource types in scope.

| Azure role | Shortest path | Example |
|---|---|---|
| 📌 *Name of the Azure role.* | *The typical shortest path to escalate privileges with the Azure role. <br> It does **not** mean this is the only possible path. In most cases, a large number of paths are possible, but the idea is to document the "typical" shortest path to demonstrate the risk.* | *A concrete high-level example with a Threat Actor (TA), illustrating the "Shortest path".* |
| [App Compliance Automation Administrator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#app-compliance-automation-administrator) | Can delete all resource groups within reach with the resources they contain, and affect the availability of those resources.<br> Note: this role is "Contributor-like", as it affects the availability of the resources within reach in the same way as a Contributor. | TA is "App Compliance Automation Administrator" on a subscription and deletes all of its resource groups, making all resources in the subscription unavailable. | 
| [Automation Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#automation-contributor) | Same as [Contributor](#contributor), but limited to resources of type: [Automation Account](https://learn.microsoft.com/en-us/azure/automation/quickstarts/create-azure-automation-account-portal). | Same as [Contributor](#contributor), but limited to resources of type: [Automation Account](https://learn.microsoft.com/en-us/azure/automation/quickstarts/create-azure-automation-account-portal). | 
| [Azure AI Administrator](https://management.azure.com/b78c5d69-af96-48a3-bf8d-a8b4d589de94?api-version=2022-04-01) | Same as [Contributor](#contributor), but limited to resources of type: [AI Search](https://learn.microsoft.com/en-us/azure/search/search-what-is-azure-search), [Azure AI services](https://learn.microsoft.com/en-us/azure/ai-services/multi-service-resource?pivots=azportal), [Data Factory](https://learn.microsoft.com/en-us/azure/data-factory/introduction), [Key Vault](https://learn.microsoft.com/en-us/azure/key-vault/general/overview). <br>Note: has also full access to the control plane of [Azure Container Registry](https://learn.microsoft.com/en-us/azure/container-registry/container-registry-intro), [Cosmos DB](https://learn.microsoft.com/en-us/azure/cosmos-db/introduction), [Machine Learning](https://learn.microsoft.com/en-us/azure/machine-learning/overview-what-is-azure-machine-learning?view=azureml-api-2), [Storage Account](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview). | Same as [Contributor](#contributor), but limited to resources of type: [AI Search](https://learn.microsoft.com/en-us/azure/search/search-what-is-azure-search), [Azure AI services](https://learn.microsoft.com/en-us/azure/ai-services/multi-service-resource?pivots=azportal), [Data Factory](https://learn.microsoft.com/en-us/azure/data-factory/introduction), [Key Vault](https://learn.microsoft.com/en-us/azure/key-vault/general/overview). <br>Note: has also full access to the control plane of: [Azure Container Registry](https://learn.microsoft.com/en-us/azure/container-registry/container-registry-intro), [Cosmos DB](https://learn.microsoft.com/en-us/azure/cosmos-db/introduction), [Machine Learning](https://learn.microsoft.com/en-us/azure/machine-learning/overview-what-is-azure-machine-learning?view=azureml-api-2), [Storage Account](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview). |
| [Azure Kubernetes Service Cluster Admin Role](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-kubernetes-service-cluster-admin-role) <a id='azure-kubernetes-service-cluster-admin-role'></a> | Can become cluster admin in all [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/en-us/azure/aks/what-is-aks) clusters within reach and take them over entirely. | TA is "AKS Cluster Admin Role" on a subscription with an AKS cluster, and takes it over. From there, TA can dump all Secrets used within the cluster and leverage them to attempt pivoting to the Azure infrastructure. TA can also take over nodes within the cluster and attempt spreading to the cloud infrastructure via network-based attacks. | 
| [Azure Kubernetes Service Cluster User Role](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-kubernetes-service-cluster-user-role) | In the [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/en-us/azure/aks/what-is-aks) clusters within reach, can access the Kubernetes resources allowed by the (Cluster)RoleBindings configured for the principal with that role. If (Cluster)RoleBindings are configured poorely, the role may allow privilege escalations similar to an [Azure Kubernetes Service RBAC Admin](#azure-kubernetes-service-rbac-admin). | TA has the "AKS Cluster User Role" on a single cluster, within which roleBindings provide full access to all resources within a specific Kubernetes namespace. TA can follow the same path as an [Azure Kubernetes Service RBAC Admin](#azure-kubernetes-service-rbac-admin). | 
| [Azure Kubernetes Service Contributor Role](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-kubernetes-service-contributor-role) <a id='azure-kubernetes-service-contributor-role'></a> | In the [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/en-us/azure/aks/what-is-aks) clusters within reach, can change their authentication and authorization schemes to Kubernetes RBAC, set the cluster-admin group to a security group for which the compromised user is a member, and take over the clusters entirely. | TA has the "AKS Contributor Role" on a single cluster. TA sets the cluster's authentication and authorization scheme to "Microsoft Entra ID authentication with Kubernetes RBAC", and the cluster-admin group to a security group for which TA is a member. TA can log in to the cluster as cluster admin and follow the same path as the [Azure Kubernetes Service Cluster Admin Role](#azure-kubernetes-service-cluster-admin-role). |
| [Azure Kubernetes Service RBAC Admin](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-kubernetes-service-rbac-admin) <a id='azure-kubernetes-service-rbac-admin'></a> | In the [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/en-us/azure/aks/what-is-aks) clusters within reach, can become admin in one or multiple namespaces, allowing privilege escalations similar to the [Azure Kubernetes Service Cluster Admin Role](#azure-kubernetes-service-cluster-admin-role) | TA is "AKS RBAC Admin" on a single cluster, with admin access to a few namespaces. TA can attempt deploying a privileged container within one of the namespaces to escape to an AKS node and take over the cluster. From there, a similar path to the [Azure Kubernetes Service Cluster Admin Role](#azure-kubernetes-service-cluster-admin-role) can be followed. TA can also leverage accessible Kubernetes Secrets to attempt pivoting to the Azure infrastructure. | 
| [Azure Kubernetes Service RBAC Cluster Admin](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-kubernetes-service-rbac-cluster-admin) | Same  as the [Azure Kubernetes Service Cluster Admin Role](#azure-kubernetes-service-cluster-admin-role). | Same as the [Azure Kubernetes Service Cluster Admin Role](#azure-kubernetes-service-cluster-admin-role). |
| [Azure Kubernetes Service RBAC Writer](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-kubernetes-service-rbac-writer) | Same as [Azure Kubernetes Service RBAC Admin](#azure-kubernetes-service-rbac-admin). | Same as [Azure Kubernetes Service RBAC Admin](#azure-kubernetes-service-rbac-admin). |
| [Cognitive Services Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#cognitive-services-contributor) | Same as [Contributor](#contributor), but limited to all resources within the [Azure AI services](https://learn.microsoft.com/en-us/azure/ai-services/what-are-ai-services#available-azure-ai-services) category. | Same as [Contributor](#contributor), but limited to all resources within the [Azure AI services](https://learn.microsoft.com/en-us/azure/ai-services/what-are-ai-services#available-azure-ai-services) category. |
| [Cognitive Services OpenAI Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#cognitive-services-openai-contributor) | Same as [Contributor](#contributor), but limited to resources of type: [Azure OpenAI](https://learn.microsoft.com/en-us/azure/ai-services/openai/overview). | Same as [Contributor](#contributor), but limited to resources of type: [Azure OpenAI](https://learn.microsoft.com/en-us/azure/ai-services/openai/overview). | 
| [Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor) <a id='contributor'></a> | Can run commands on compute resources within reach that are assigned Managed Identities with permissions to other scopes, and escalate privileges. | TA is Contributor on a subscription containing Logic Apps and Automation Accounts. The Automation Accounts are assigned Managed Identities (MIs) with Contributor access to other subscriptions, while the Logic Apps have MIs with [MS Graph application permissions](https://github.com/emiliensocchi/azure-tiering/tree/main/Microsoft%20Graph%20application%20permissions). TA can leverage the Automation Accounts and Logic Apps to impersonate the MIs and escalate privileges within Azure and MS Graph. <br> Note: many paths of this kind are possible with other types of compute resources. | 
| [Desktop Virtualization Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#desktop-virtualization-contributor) | Same as [Contributor](#contributor), but limited to resources of type: [Azure Virtual Desktop](https://learn.microsoft.com/en-us/azure/virtual-desktop/overview). | Same as [Contributor](#contributor), but limited to resources of type: [Azure Virtual Desktop](https://learn.microsoft.com/en-us/azure/virtual-desktop/overview). |
| [Desktop Virtualization Virtual Machine Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#desktop-virtualization-virtual-machine-contributor) | Same as [Contributor](#contributor), but limited to resources of type: [Azure Virtual Desktop](https://learn.microsoft.com/en-us/azure/virtual-desktop/overview), [Virtual Machine](https://learn.microsoft.com/en-us/azure/virtual-machines/overview). | Same as [Contributor](#contributor), but limited to resources of type: [Azure Virtual Desktop](https://learn.microsoft.com/en-us/azure/virtual-desktop/overview), [Virtual Machine](https://learn.microsoft.com/en-us/azure/virtual-machines/overview). |
| [Kubernetes Agent Operator](https://learn.microsoft.com/en-us/azure/defender-for-cloud/containers-permissions#azure-arc-provisioning-role-for-eks-and-gke) <a id='kubernetes-agent-operator'></a> | Can create a [trusted access role binding](https://learn.microsoft.com/en-us/rest/api/aks/trusted-access-role-bindings?view=rest-aks-2024-10-01) between the compromised principal and the [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/en-us/azure/aks/what-is-aks) clusters within reach, using the "inference-v1" access role ([list trusted access roles](https://learn.microsoft.com/en-us/rest/api/aks/trusted-access-roles/list?view=rest-aks-2024-10-01&tabs=HTTP)). This provides full access to pod and secret resources within the cluster(s). | TA is "Kubernetes Agent Operator" on a single cluster. TA creates a new trusted role access role binding between the compromised principal and the cluster, using the "inference-v1" access role. TA has now full access to Kubernetes Pod and Secret resources within the cluster. TA can attempt deploying a privileged container to escape to an AKS node and take over the cluster. From there, a similar path to the [Azure Kubernetes Service Cluster Admin Role](#azure-kubernetes-service-cluster-admin-role) can be followed. TA can also leverage accessible Kubernetes Secrets to attempt pivoting to the Azure infrastructure <br>Note: following the same path as the [Azure Kubernetes Service Contributor Role](#azure-kubernetes-service-contributor-role) is usually not possible, as the "Kubernetes Agent Operator" role is typically assigned to a Managed Identity (i.e. not a user). |
| [Kubernetes Agentless Operator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#kubernetes-agentless-operator) | Same as [Kubernetes Agent Operator](#kubernetes-agent-operator). | Same as [Kubernetes Agent Operator](#kubernetes-agent-operator). | 
| [Logic App Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#logic-app-contributor) <a id='logic-app-contributor'></a> | Same as [Contributor](#contributor), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a consumption plan. | Same as [Contributor](#contributor), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a consumption plan. | 
| [Logic Apps Standard Contributor (Preview)](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#logic-apps-standard-contributor-preview) | Same as [Contributor](#contributor), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a standard plan. | Same as [Contributor](#contributor), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a standard plan. | 
| [Managed Identity Operator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#managed-identity-operator) | Can assign the user-assigned Managed Identities within reach to a compute resource in the same scope and endorse their permissions to escalate privileges. | TA is "Managed Identity Operator" on a subscription with multiple user-assigned Managed Identities (MIs), and where they control an App Service. One of the MIs has Contributor access to the entire subscription where the MIs are located. TA assigns the MI to the App Service and leverages the latter to escalate privileges and take over all resources within the subscription via the new Contributor access. |
| [Owner](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#owner) | Same as [Contributor](#contributor). | Same as [Contributor](#contributor). | 
| [Reservations Administrator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#reservations-administrator) | Can assign the [Contributor](#contributor) role to compromised principal and follow the same path. |  Can assign the [Contributor](#contributor) role to compromised principal and follow the same path. |
| [Resource Policy Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#resource-policy-contributor) <a id='resource-policy-contributor'></a> | In [Azure Policy](https://learn.microsoft.com/en-us/azure/governance/policy/overview), can modify a `DeployIfNotExist` policy already assigned, to impersonate the Managed Identity used for the assignment, take over compute resources within reach, and follow the same path as [Contributor](#contributor). | In Azure Policy, a `DeployIfNotExist` policy is already assigned on a subscription. The policy assignment uses a Managed Identity with Contributor access on the subscription to enforce changes defined by the policy. TA modifies the policy, so that it executes arbitrary commands in compute resources within the subscription on new deployments (e.g. running a reverse shell). A new Virtual Machine (VM) is deployed, the reverse-shell command is executed and TA takes over the VM. From there, the same path as [Contributor](#contributor) can be followed. | 
| [Role Based Access Control Administrator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#role-based-access-control-administrator) | Can assign the [Contributor](#contributor) role to compromised principal and follow the same path. |  Can assign the [Contributor](#contributor) role to compromised principal and follow the same path. |
| [Security Admin](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#security-admin) | Same as [Resource Policy Contributor](#resource-policy-contributor). | Same as [Resource Policy Contributor](#resource-policy-contributor). | 
| [User Access Administrator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#user-access-administrator) | Can assign the [Contributor](#contributor) role to the compromised principal and follow the same path. |  Can assign the [Contributor](#contributor) role to the compromised principal and follow the same path. |
| [Virtual Machine Administrator Login](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#virtual-machine-administrator-login) | Same as [Contributor](#contributor), but limited to resources of type: [Virtual Machine](https://learn.microsoft.com/en-us/azure/virtual-machines/overview). | Same as [Contributor](#contributor), but limited to resources of type: [Virtual Machine](https://learn.microsoft.com/en-us/azure/virtual-machines/overview). | 
| [Virtual Machine Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#virtual-machine-contributor) | Same as [Contributor](#contributor), but limited to resources of type: [Virtual Machine](https://learn.microsoft.com/en-us/azure/virtual-machines/overview). | Same as [Contributor](#contributor), but limited to resources of type: [Virtual Machine](https://learn.microsoft.com/en-us/azure/virtual-machines/overview). | 
| [Virtual Machine User Login](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#virtual-machine-user-login) | Same as [Contributor](#contributor), but limited to resources of type: [Virtual Machine](https://learn.microsoft.com/en-us/azure/virtual-machines/overview). | Same as [Contributor](#contributor), but limited to resources of type: [Virtual Machine](https://learn.microsoft.com/en-us/azure/virtual-machines/overview). | 
| [Website Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/#website-contributor) | Same as [Contributor](#contributor), but limited to resources of type: [App Service](https://learn.microsoft.com/en-us/azure/app-service/overview), [Function App](https://learn.microsoft.com/en-us/azure/azure-functions/functions-overview). | Same as [Contributor](#contributor), but limited to resources of type: [App Service](https://learn.microsoft.com/en-us/azure/app-service/overview), [Function App](https://learn.microsoft.com/en-us/azure/azure-functions/functions-overview). | 


<a id='tier-1'></a>
## 🟠 Tier 1: Family of lateral navigators

**Description**: roles with a risk of lateral movement via data-plane access to a specific resource type in scope, but with a limited risk for privilege escalation.

| Azure role | Shortest path | Example |
|---|---|---|
| 📌 *Name of the Azure role.* | *The typical shortest path to move laterally with the Azure role. <br> It does **not** mean this is the only possible path. In most cases, a large number of paths are possible, but the idea is to document the "typical" shortest path to demonstrate the risk.* | *A concrete high-level example with a Threat Actor (TA), illustrating the "Shortest path".* |
| [AcrPush](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#acrpush) | Can infect container images hosted on [Azure Container Registry](https://learn.microsoft.com/en-us/azure/container-registry/container-registry-get-started-portal?tabs=azure-cli) (ACR) instances within reach that are network accessible, and move laterally to the infrastructure(s) where the images are deployed. | TA has "AcrPush" access to an ACR exposed on a non-restricted public endpoint. TA infects its base images with a reverse-shell backdoor ([more info](https://www.emiliensocchi.io/infecting-container-images-to-spread-in-large-scale-container-based-infrastructures-like-kubernetes/)). During application deployments, the infected images are extended to build and deploy applications to Kubernetes clusters, allowing TA to move laterally to multiple locations within those clusters. | 
| [App Configuration Data Owner](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#app-configuration-data-owner) <a id='app-config-data-owner'></a> | Can steal secrets to move laterally to other resources, if stored insecurely in the [App Configuration](https://learn.microsoft.com/en-us/azure/azure-app-configuration/quickstart-azure-app-configuration-create?tabs=azure-portal) instances within reach. | TA is "App Configuration Data Owner" on a subscription with 3 App Configuration instances. One of them contains hard-coded connection strings to Storage Accounts and SQL Servers. TA can attempt to use them to move laterally to those resources. |
| [App Configuration Data Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#app-configuration-data-reader) | Same as [App Configuration Data Owner](#app-config-data-owner). | Same as [App Configuration Data Owner](#app-config-data-owner). | 
| [Azure AI Inference Deployment Operator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-ai-inference-deployment-operator) | Same as [Reader](#reader). | Same as [Reader](#reader). | 
| [Azure Event Hubs Data Owner](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-event-hubs-data-owner) <a id='azure-event-hubs-data-owner'></a> | Can steal secrets managed insecurely and flowing through the [Event Hub](https://learn.microsoft.com/en-us/azure/event-hubs/event-hubs-about) instances within reach that are network accessible, and/or tamper with the data to attempt moving laterally to other consuming systems. | TA is "Azure Event Hubs Data Owner" on an Event Hub instance exposed on a non-restricted public endpoint and used for forwarding logs. The logs are incorrectly sanitized for secrets, and TA finds connection strings to other Azure resources. TA can attempt to use them to move laterally to those resources. | 
| [Azure Event Hubs Data Receiver](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-event-hubs-data-receiver) <a id='azure-event-hubs-data-receiver'></a> | Can steal secrets managed insecurely and flowing through the [Event Hub](https://learn.microsoft.com/en-us/azure/event-hubs/event-hubs-about) instances within reach that are network accessible, and leverage those to move laterally to other resources. | TA is "Azure Event Hubs Data Receiver" on an Event Hub instance exposed on a non-restricted public endpoint and used for forwarding logs. The logs are incorrectly sanitized for secrets, and TA finds connection strings to other Azure resources. TA can attempt to use them to move laterally to those resources. | 
| [Azure Event Hubs Data Sender](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-event-hubs-data-sender) <a id='azure-event-hubs-data-sender'></a> | Can send malicious data to the [Event Hub](https://learn.microsoft.com/en-us/azure/event-hubs/event-hubs-about) instances within reach that are network accessible, to attempt moving laterally to other consuming systems. | TA is "Azure Event Hubs Data Sender" on an Event Hub instance that is exposed on a non-restricted public endpoint and used to forward logs to a SQL database. The logs are insecurely inserted into the database. TA is able to send SQL injection queries to the Event Hub, and attempt to pivot to the log database. |
| [Azure Kubernetes Service RBAC Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-kubernetes-service-rbac-reader) | In the [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/en-us/azure/aks/what-is-aks) clusters within reach that are network accessible, can steal secrets to move laterally to other resources, if stored insecurely in certain types of Kubernetes resources accessible to the role. | TA is "AKS RBAC Reader" on a single cluster exposed on a non-restricted public endpoint, which provides view access to the cluster's namespaces. Some namespaces contain ConfigMaps with hard-coded connection strings to Azure SQL databases, Storage Accounts and Key Vaults. TA can attempt to use them to move laterally to those resources. |
| [Azure Service Bus Data Owner](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-service-bus-data-owner) | Same as [Azure Event Hubs Data Owner](#azure-event-hubs-data-owner), but with resources of type: [Azure Service Bus](https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview). | Same as [Azure Event Hubs Data Owner](#azure-event-hubs-data-owner), but with resources of type: [Azure Service Bus](https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview). | 
| [Azure Service Bus Data Sender](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-service-bus-data-sender) | Same as [Azure Event Hubs Data Sender](#azure-event-hubs-data-sender), but with resources of type: [Azure Service Bus](https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview). | Same as [Azure Event Hubs Data Sender](#azure-event-hubs-data-sender), but with resources of type: [Azure Service Bus](https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview). | 
| [Azure Service Bus Data Receiver](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#azure-service-bus-data-receiver) | Same as [Azure Event Hubs Data Receiver](#azure-event-hubs-data-receiver), but with resources of type: [Azure Service Bus](https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview). | Same as [Azure Event Hubs Data Receiver](#azure-event-hubs-data-receiver), but with resources of type: [Azure Service Bus](https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview). | 
| [Defender CSPM Storage Scanner Operator](https://management.azure.com/8480c0f0-4509-4229-9339-7c10018cb8c4?api-version=2022-04-01) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Files and Blob service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach. | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Files and Blob service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach. | 
| [Defender for Storage Scanner Operator](https://management.azure.com/0f641de8-0b88-4198-bdef-bd8b45ceba96?api-version=2022-04-01) | Can assign the [Defender for Storage Data Scanner](#defender-for-storage-data-scanner) and [Event Grid Data Sender](#eventgrid-data-sender) roles to all [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) and [Event Grids](https://learn.microsoft.com/en-us/azure/event-grid/overview) within reach, and follow the same paths as those roles. | TA is "Defender for Storage Scanner Operator" on a subscription with Event Grids. TA assigns the [Event Grid Data Sender](#eventgrid-data-sender) role to the compromised principal and follows the same path as that role. | 
| [Disk Snapshot Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#disk-snapshot-contributor) <a id='disk-snapshot-contributor'></a> | Can download all [Azure Disk Snapshots](https://learn.microsoft.com/en-us/azure/virtual-machines/snapshot-copy-managed-disk?tabs=portal) within reach and read their content locally, where some of them may contain sensitive data. Can also access the content of all [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach, where some of them may contain sensitive data. | TA is "Disk Snapshot Contributor" on a subscription with multiple snapshots. For each snapshot, TA creates a SAS URI to export its content to an external location and review it for sensitive data. <br>TA can also follow the same path as [Storage Account Contributor](#storage-account-contributor). |
| [DNS Zone Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#dns-zone-contributor) <a id='dns-zone-contributor'></a> | Can modify all [Azure DNS zones](https://learn.microsoft.com/en-us/azure/dns/dns-zones-records) within reach, and conduct DNS hijacking attacks on the environment. | TA is "DNS Zone Contributor" on a subscription with multiple Azure DNS zones. In every zone, TA alters key records to redirect legitimate traffic to a TA-controlled location, in view of hijacking network traffic. | 
| [Domain Services Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#domain-services-contributor) | Can modify the following network resources within reach, to leverage network based attacks from a controlled compute instance: [Virtual Networks (VNets)](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview), [Network Security Groups (NSG)](https://learn.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview), [Route tables](https://learn.microsoft.com/en-us/azure/virtual-network/manage-route-table), [Load Balancers](https://learn.microsoft.com/en-us/azure/load-balancer/load-balancer-overview). <br>Note: can modify basic configuration for [Microsoft Entra Domain Services](https://learn.microsoft.com/en-us/entra/identity/domain-services/overview) instances within reach, but does not provide access to the underlying Domain Controllers. | TA is "Domain Services Contributor" on a subscription where they control a Virtual Machine (VM). TA modifies VNet peering, routing tables and NSG rules, to allow network-based attacks from the controlled VM to other compute resources within the subscription (including the DC(s) used by Entra Domain Services). | 
| [EventGrid Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#eventgrid-contributor) <a id='eventgrid-contributor'></a> | Can send malicious topic events to the [Event Grid](https://learn.microsoft.com/en-us/azure/event-grid/overview) within reach that are network accessible, to attempt moving laterally to other consuming systems. | TA is "EventGrid Contributor" on an Event Grid instance that is exposed on a non-restricted public endpoint, and notifies on the creation of new files in a blob Storage Account. The events are insecurely consumed by another internal system, which trusts the events without further sanitization. TA is able to send SQL injection queries, SSRF payloads, etc. to the Event Grid, and attempt to pivot to the internal system. | 
| [EventGrid Data Sender](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#eventgrid-data-sender) <a id='eventgrid-data-sender'></a> | Same as [EventGrid Contributor](#eventgrid-contributor). | Same as [EventGrid Contributor](#eventgrid-contributor). | 
| [Grafana Admin](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#grafana-admin) | Can steal secrets managed insecurely and flowing through the [Managed Grafana](https://learn.microsoft.com/en-us/azure/managed-grafana/overview) instances within reach that are network accessible, and leverage those to move laterally to other resources. | TA is "Grafana Admin" on a Managed Grafana instance exposed on a non-restricted public endpoint. Some of the ingested logs are incorrectly sanitized for secrets, and TA finds connection strings to other Azure resources. TA can attempt to use them to move laterally to those resources. | 
| [Key Vault Administrator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-administrator) <a id='key-vault-administrator'></a> | Same as [Key Vault Contributor](#key-vault-contributor), but constrained to instances using the "Azure role-based access control" permission model. | Same as [Key Vault Contributor](#key-vault-contributor), but constrained to instances using the "Azure role-based access control" permission model. | 
| [Key Vault Certificate User](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-certificate-user) |  Same as [Key Vault Contributor](#key-vault-contributor), but constrained to instances using the "Azure role-based access control" permission model. | Same as [Key Vault Contributor](#key-vault-contributor), but constrained to instances using the "Azure role-based access control" permission model. | 
| [Key Vault Certificates Officer](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-certificates-officer) | Can steal certificates in the [Key Vaults](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates#object-types) within reach that are using the "Azure role-based access control" permission model and are network accessible, to move laterally to other resources. | TA is "Key Vault Certificates Officer" on a single Key Vault that is exposed on a non-restricted public endpoint. TA can leverage the Key Vault's certificates to move laterally to the affected resources. | 
| [Key Vault Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-contributor) <a id='key-vault-contributor'></a>| Can steal all objects types in the [Key Vaults](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates#object-types) within reach (e.g. secrets, certificates, Storage Account keys, etc.) to move laterally to other resources. | TA is "Key Vault Contributor" on a subscription with multiple Key Vaults. TA can leverage all objects stored in each Key Vault (e.g. access keys, connection strings, client secrets, etc.) to move laterally to the affected resources. | 
| [Key Vault Data Access Administrator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-data-access-administrator) | Can assign the [Key Vault Administrator](#key-vault-administrator) role to the compromised principal and follow the same path as that role. | Can assign the [Key Vault Administrator](#key-vault-administrator) role to the compromised principal and follow the same path as that role. | 
| [Key Vault Secrets Officer](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-secrets-officer) <a id='key-vault-secrets-officer'></a> | Same as [Key Vault Contributor](#key-vault-contributor), but constrained to secret objects and [Key Vault](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates#object-types) instances using the "Azure role-based access control" permission model, and exposed on a non-restricted public endpoint. | Same as [Key Vault Contributor](#key-vault-contributor), but constrained to secret objects and [Key Vault](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates#object-types) instances using the "Azure role-based access control" permission model, and exposed on a non-restricted public endpoint. |
| [Key Vault Secrets User](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-secrets-user) | Same as [Key Vault Secrets Officer](#key-vault-secrets-officer). | Same as [Key Vault Secrets Officer](#key-vault-secrets-officer). | 
| [Log Analytics Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#log-analytics-contributor) <a id='log-analytics-contributor'></a> | Can access the content of all [Log Analytics Workspaces](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview) and [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible, and where some of them may contain sensitive data, and/or where their data can be tampered with to attempt moving laterally to other consuming systems. | TA is "Log Analytics Contributor" on a subscription with multiple Log Analytics Workspaces that allow query access from any network. TA finds a Workspace with custom logs incorrectly sanitized for secrets, and finds connection strings to other Azure resources. TA can attempt to use them to move laterally to those resources. | 
| [Logic App Operator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#logic-app-operator) <a id='logic-app-operator'></a> | In the [Logic Apps](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) within reach that are using a consumption plan, can read secrets managed insecurely (e.g. hard-coded in step parameters, returned in insecure outputs, etc.), and leverage those to attempts moving laterally. | TA is "Logic App Operator" on a subscription with multiple Logic Apps, where some of them have hard-coded secrets in step parameters. TA can leverage those secrets to attempt moving laterally to the affected resources. | 
| [Logic Apps Standard Developer (Preview)](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#logic-apps-standard-developer-preview) | Same as [Logic App Operator](#logic-app-operator), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a standard plan. | Same as [Logic App Operator](#logic-app-operator), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a standard plan. | 
| [Logic Apps Standard Operator (Preview)](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#logic-apps-standard-operator-preview) | Same as [Logic App Operator](#logic-app-operator), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a standard plan. | Same as [Logic App Operator](#logic-app-operator), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a standard plan. | 
| [Logic Apps Standard Reader (Preview)](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#logic-apps-standard-reader-preview) | Same as [Logic App Operator](#logic-app-operator), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a standard plan. | Same as [Logic App Operator](#logic-app-operator), but limited to resources of type: [Logic App](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) using a standard plan. | 
| [Microsoft Sentinel Automation Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#microsoft-sentinel-automation-contributor) | Can read workflow run history in the [Logic Apps](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) within reach that are using a consumption plan, and for which run history is network accessible. If secrets are managed insecurely in the Logic App within reach, those can be read and leveraged to attempt moving laterally to the affected resources. | TA is "Microsoft Sentinel Contributor" on a resource group with multiple Logic Apps, where some of them have hard-coded secrets in step parameters that reflect in run history. Network access to run history is unrestricted, and TA can leverage those secrets to attempt moving laterally to the affected resources. |  
| [Microsoft Sentinel Playbook Operator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#microsoft-sentinel-playbook-operator) | Can read workflows in the [Logic Apps](https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare#logic-app-workflow-types-and-environments) within reach that are using a consumption plan. If secrets are managed insecurely in the Logic App within reach, those can be read and leveraged to attempt moving laterally to the affected resources.<br>Note: a workflow belongs to the control plane of a Logic App and is not subject to network access limitations. | TA is "Microsoft Sentinel Contributor" on a resource group with multiple Logic Apps, where some of them have hard-coded secrets in step parameters. TA can leverage those secrets to attempt moving laterally to the affected resources. | 
| [Private DNS Zone Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#private-dns-zone-contributor) | Same as [DNS Zone Contributor](#dns-zone-contributor), but limited to resources of type: [Private DNS Zone](https://learn.microsoft.com/en-us/azure/dns/private-dns-privatednszone). | Same as [DNS Zone Contributor](#dns-zone-contributor), but limited to resources of type: [Private DNS Zone](https://learn.microsoft.com/en-us/azure/dns/private-dns-privatednszone). |
| [Network Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#network-contributor) | Can modify all [network resources](https://learn.microsoft.com/en-us/azure/role-based-access-control/permissions/networking#microsoftnetwork) within reach (e.g. [Azure Firewall](https://learn.microsoft.com/en-us/azure/firewall/overview), [Virtual Networks](https://learn.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview), [Application Gateways](https://learn.microsoft.com/en-us/azure/application-gateway/overview), etc.) to leverage access from a compute resource and extend its network attack surface. Can also follow the same path as a [DNS Zone Contributor](#dns-zone-contributor). | TA is "Network Contributor" on a subscription where they already control a Virtual Machine (VM). TA changes the network in the subscription to allow key resources to be reachable from the controlled VM. TA conducts network-based attacks to attempt moving laterally to those resources. | 
| [Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#reader) <a id='reader'></a> | Can steal secrets to move laterally to other resources, if stored insecurely in certain types of resources that are accessible to the Reader role. | TA is "Reader" on a subscription that contains Logic Apps using hard-coded secrets in step parameters. TA can leverage those secrets to attempt moving laterally to the affected resources. |
| [Reader and Data Access](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#reader-and-data-access) | Can follow the same path as [Storage Account Contributor](#storage-account-contributor), by retrieving the access keys of all [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that allow access-key authentication and are network accessible. | Can follow the same path as [Storage Account Contributor](#storage-account-contributor), by regenerating the access keys of all [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that allow access-key authentication and are network accessible. | 
| [Redis Cache Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#redis-cache-contributor) | Same as [Azure Event Hubs Data Owner](#azure-event-hubs-data-owner), but with resources of type: [Azure Cache for Redis](https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-overview). | Same as [Azure Event Hubs Data Owner](#azure-event-hubs-data-owner), but with resources of type: [Azure Cache for Redis](hhttps://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-overview). | 
| [Storage Account Backup Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-account-backup-contributor) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Blob service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Blob service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | 
| [Storage Account Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-account-contributor) <a id='storage-account-contributor'></a> | Can access the content of all [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach, where some of them may contain sensitive data, and/or data that can be tampered with to attempt moving laterally to other consuming systems. | TA is "Storage Account Contributor" on a subscription with multiple Storage Accounts. One of them contains cold-storage logs incorrectly sanitized for secrets, and TA finds connection strings to other Azure resources. TA can attempt to use them to move laterally to those resources. | 
| [Storage Account Key Operator Service Role](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-account-key-operator-service-role) | Can follow the same path as [Storage Account Contributor](#storage-account-contributor), by regenerating the access keys of all [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that allow access-key authentication and are network accessible. | Can follow the same path as [Storage Account Contributor](#storage-account-contributor), by regenerating the access keys of all [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that allow access-key authentication and are network accessible. | 
| [Storage Blob Data Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-blob-data-contributor) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Blob service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Blob service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | 
| [Storage Blob Data Owner](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-blob-data-owner) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Blob service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Blob service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | 
| [Storage Blob Data Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-blob-data-reader) | Can access the content of the Blob service in [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible, where some of them may contain sensitive data. | TA is "Storage Blob Data Reader" on a subscription with multiple Storage Accounts that are exposed on non-restricted public endpoints. One of them contains cold-storage logs incorrectly sanitized for secrets, and TA finds connection strings to other Azure resources. TA can attempt to use the connection strings to move laterally to those resources. | 
| [Storage Blob Delegator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-blob-delegator) | Can create Shared Access Signature (SAS) tokens, to access to the content of the Blob service in [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. Some of the blobs may contain sensitive data, and/or data that can be tampered with to attempt moving laterally to other consuming systems. | TA is "Storage Blob Delegator" on a subscription with multiple Storage Accounts exposed on non-restricted public endpoints. TA creates SAS tokens for all of them, and finds a Storage Account containing cold-storage logs incorrectly sanitized for secrets. TA finds connection strings to other Azure resources and can attempt to use them to move laterally to those resources. | 
| [Storage File Data Privileged Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-file-data-privileged-contributor) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Files service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible (from a private location). | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Files service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible (from a private location). | 
| [Storage File Data Privileged Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-file-data-privileged-reader) <a id='storage-file-data-privileged-reader'></a> | Can access the content of the Files service in [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible (from a private location), where some of them may contain sensitive data. | TA is "Storage File Data Privileged Reader" on a single Storage Account and has network access to it from a specific Virtual Network (VNet). A file share in the Storage Account contains files with hard-coded credentials to other Azure resources. TA can attempt to use the connection strings to move laterally to those resources. | 
| [Storage File Data SMB Share Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-file-data-smb-share-contributor) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Files service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible (from a private location). | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Files service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible (from a private location). | 
| [Storage File Data SMB Share Elevated Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-file-data-smb-share-elevated-contributor) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Files service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible (from a private location). | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Files service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible (from a private location). | 
| [Storage File Data SMB Share Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-file-data-smb-share-reader) | Same as [Storage File Data Privileged Reader](#storage-file-data-privileged-reader). | Same as [Storage File Data Privileged Reader](#storage-file-data-privileged-reader). | 
| [Storage Queue Data Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-queue-data-contributor) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Queue service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Queue service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. |  
| [Storage Table Data Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#storage-table-data-contributor) | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Table service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | Same as [Storage Account Contributor](#storage-account-contributor), but constrained to the Table service in the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview) within reach that are network accessible. | 
| [Windows 365 Network Interface Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#windows-365-network-interface-contributor) | Can create a network interface and assign it to an existing Virtual Machine (VM) to extend its network attack surface. | TA is "W365 Network Interface Contributor" on a subscription with multiple VMs. TA creates and associates network interfaces to expose the VMs on non-restricted public endpoints, to conduct network-based attacks from the Internet, and attempt to move laterally to those resources. |


<a id='tier-2'></a>
## 🟡 Tier 2: Family of data explorers

**Description**: roles with data-plane access to a specific resource type in scope, but with a limited risk for lateral movement and without a risk for privilege escalation.

| Azure role | Worst-case scenario |
|---|---|
| 📌 *Name of the Azure role.* | *The worst-case scenario in case a principal with the Azure role is compromised.* |
| [AcrPull](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#acrpull) | Can pull all container images hosted in the [Azure Container Registry](https://learn.microsoft.com/en-us/azure/container-registry/container-registry-get-started-portal?tabs=azure-cli) (ACR) instances within reach that are network accessible, and attempt to retrieve secrets that might be stored insecurely in the images. | 
| [Backup Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#backup-contributor) | Can delete all backup instances within reach, and affect the availability of those resources. <br>Note: cannot access the content of the backups. | 
| [Cognitive Services OpenAI User](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#cognitive-services-openai-user) | In the [Azure OpenAI](https://learn.microsoft.com/en-us/azure/ai-services/openai/overview) instances within reach that are network accessible, can read all uploaded data sets, where some of them may contain sensitive data. | 
| [Cognitive Services User](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#cognitive-services-openai-user) | In the [Azure AI services](https://learn.microsoft.com/en-us/azure/ai-services/what-are-ai-services#available-azure-ai-services) instances within reach that are network accessible, can read all uploaded data sets, where some of them may contain sensitive data. Can also read access keys to consume instances in an uncontrolled manner. | 
| [Data Factory Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#data-factory-contributor) | In the [Data Factory](https://learn.microsoft.com/en-us/azure/data-factory/introduction) instances within reach that are network accessible, can read all datasets, where some of them may contain sensitive data. Can also delete pipelines, datasets and integration runtimes, to affect the availability of the Data Factory instances. <br>Note: cannot access Data Factory nodes without additional permissions on Virtual Machines. | 
| [Data Purger](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#data-purger) | In the [Log Analytics workspaces](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview) within reach and for which ingestion is network accessible, can delete data to affect monitoring and incident response abilities. <br>Note: cannot read data within the workspaces. | 
| [Defender for Storage Data Scanner](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#defender-for-storage-data-scanner) <a id='defender-for-storage-data-scanner'></a> | In the [Storage Accounts](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction#blob-storage-resources) within reach that are network accessible, can read all files stored in Azure Blob Storage, where some of them may contain sensitive data.<br>Note: cannot modify files. | 
| [Desktop Virtualization User](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#desktop-virtualization-user) | In the [Azure Virtual Desktop](https://learn.microsoft.com/en-us/azure/virtual-desktop/overview) instances within reach that are network accessible, can access all applications available to the user, where some of them may contain sensitive data. |
| [Log Analytics Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#log-analytics-reader) <a id='log-analytics-reader'></a> | Can access the content of all [Log Analytics Workspaces](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/log-analytics-workspace-overview) within reach for which querying is network accessible, and where some of them may contain sensitive data. |
| [Microsoft Sentinel Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#microsoft-sentinel-contributor) | Same as [Log Analytics Reader](#log-analytics-reader). |
| [Microsoft Sentinel Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#microsoft-sentinel-reader) | Same as [Log Analytics Reader](#log-analytics-reader). | 
| [Microsoft Sentinel Responder](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#microsoft-sentinel-responder) | Same as [Log Analytics Reader](#log-analytics-reader). | 
| [Monitoring Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#monitoring-contributor) | Same as [Log Analytics Reader](#log-analytics-reader). | 
| [Monitoring Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#monitoring-reader) | Same as [Log Analytics Reader](#log-analytics-reader). | 
| [SQL DB Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#sql-db-contributor) <a id='sql-db-contributor'></a> | Can access the content of all [SQL databases](https://learn.microsoft.com/en-us/azure/azure-sql/database/sql-database-paas-overview?view=azuresql) within reach that are network accessible, and where some of them may contain sensitive data. | 
| [SQL Managed Instance Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#sql-managed-instance-contributor) | Same as [SQL DB Contributor](#sql-db-contributor), but limited to databases hosted on [SQL Managed Instances](https://learn.microsoft.com/en-us/azure/azure-sql/managed-instance/sql-managed-instance-paas-overview?view=azuresql) where [SQL authentication](https://learn.microsoft.com/en-us/azure/azure-sql/database/logins-create-manage?view=azuresql#authentication-and-authorization) is enabled (i.e. cannot change the server's authorization scheme, but can reset the SQL server admin password). |
| [SQL Security Manager](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#sql-security-manager) | Same as [SQL DB Contributor](#sql-db-contributor), but limited to databases hosted on SQL Servers where [SQL authentication](https://learn.microsoft.com/en-us/azure/azure-sql/database/logins-create-manage?view=azuresql#authentication-and-authorization) is enabled (i.e. cannot change the server's authorization scheme, but can reset the SQL server admin password). | 
| [SQL Server Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#sql-server-contributor) | Same as [SQL DB Contributor](#sql-db-contributor), but limited to databases hosted on SQL Servers where [SQL authentication](https://learn.microsoft.com/en-us/azure/azure-sql/database/logins-create-manage?view=azuresql#authentication-and-authorization) is enabled (i.e. cannot change the server's authorization scheme, but can reset the SQL server admin password). | 
| [VM Scanner Operator](https://management.azure.com/d24ecba3-c1f4-40fa-a7bb-4588a071e8fd?api-version=2022-04-01) | Same as [Disk Snapshot Contributor](#disk-snapshot-contributor). | 
| [Workbook Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#workbook-contributor) <a id='#workbook-contributor'></a> | Can access the content of all [Azure Workbooks](https://learn.microsoft.com/en-us/azure/azure-monitor/visualize/workbooks-overview) within reach, where some of them may contain sensitive data. | 
| [Workbook Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#workbook-reader) | Same as [Workbook Contributor](#workbook-contributor). | 


<a id='tier-3'></a>
## 🟢 Tier 3: Family of unprivileged Azure users

**Description**: roles with little to no security implications.

| Azure role | Worst-case scenario | 
|---|---|
| 📌 *Name of the Azure role.* | *If any, the worst-case scenario in case a principal with the Azure role is compromised.* |
| [Automation Job Operator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#automation-job-operator) | Can create new jobs with existing runbooks, but cannot create and/modify runbooks. | 
| [Billing Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#billing-reader) | - |
| [Blueprint Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#blueprint-contributor) | Can create and publish blueprints, but not assign them. |
| [Blueprint Operator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#blueprint-operator) | Can assign existing published blueprints, but not create and/or modify existing ones. | 
| [Cost Management Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#cost-management-contributor) |- |
| [Cost Management Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#cost-management-reader) | - |
| [Desktop Virtualization Power On Off Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#desktop-virtualization-power-on-off-contributor) | Can power off the [Azure Virtual Desktop](https://learn.microsoft.com/en-us/azure/virtual-desktop/overview) instances within reach to create service disruption. | 
| [Desktop Virtualization User Session Operator](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#desktop-virtualization-user-session-operator) | Can terminate user sessions on the [Azure Virtual Desktop](https://learn.microsoft.com/en-us/azure/virtual-desktop/overview) instances within reach to create service disruption. | 
| [Key Vault Crypto Officer](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-crypto-officer) <a id='key-vault-crypto-officer'></a> | Can overwrite existing keys in the [Key Vaults](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates#object-types) within reach using the 'Azure role-based access control' permission model, to create service disruption, but cannot retrieve key values. | 
| [Key Vault Crypto Service Encryption User](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-crypto-service-encryption-user) | Can delete event subscriptions in the [Event Grid](https://learn.microsoft.com/en-us/azure/event-grid/overview) within reach to create service disruption. Cannot retrieve key values from the [Key Vaults](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates#object-types) within reach using the 'Azure role-based access control' permission model. |
| [Key Vault Crypto User](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-crypto-user) | Can neither overwrite nor retrieve the value of imported keys in the [Key Vaults](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates#object-types) within reach using the 'Azure role-based access control' permission model. |
| [Key Vault Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#key-vault-reader) | Can list secret and certificate objects in the [Key Vaults](https://learn.microsoft.com/en-us/azure/key-vault/general/about-keys-secrets-certificates#object-types) within reach using the 'Azure role-based access control' permission model, but not retrieve their content. | 
| [Kubernetes Extension Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#kubernetes-extension-contributor) | Can delete extensions enabled in the [Azure Kubernetes Service (AKS)](https://learn.microsoft.com/en-us/azure/aks/what-is-aks) clusters within reach and create service disruption. | 
| [Managed Identity Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#managed-identity-contributor) | Can delete user-assigned Managed Identities within reach to create service disruption, but can neither assign them nor provide them permissions. | 
| [Management Group Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#management-group-contributor) | Can delete Management Groups to automatically move child subscriptions to the Tenant Root Group, and create service disruption for certain types of automated jobs. | 
| [Management Group Reader](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#management-group-reader) | - | 
| [Managed Application Operator Role](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#managed-application-operator-role) | Can remove access to the managed applications within reach to create service disruption. | 
| [Monitoring Metrics Publisher](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#monitoring-metrics-publisher) | - | 
| [Reservation Purchaser](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#reservation-purchaser) | Can cancel [Azure Reservations](https://learn.microsoft.com/en-us/azure/cost-management-billing/reservations/save-compute-costs-reservations) and increase resource cost. | 
| [Support Request Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#support-request-contributor) | - | 
| [Tag Contributor](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#tag-contributor) | - | 
| [Windows 365 Network User](https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#windows-365-network-user) | - |
